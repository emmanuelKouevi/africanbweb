{"ast":null,"code":"import axios from \"axios\";\nimport $ from 'jquery';\nimport { API_CREER_DOCUMENT_TRANSPORT, HEADERS } from '../globalConfig/globalConstConfig';\nexport default {\n  name: \"DocumentAttestionTransport\",\n  data() {\n    return {\n      successMsg: null,\n      errorMsg: null,\n      overlay: false,\n      selectedFile: null,\n      filePreview: null,\n      isImage: false,\n      compagnieTransportRaisonSociale: 'KOUEVI CT'\n    };\n  },\n  methods: {\n    submitForm() {\n      if (this.selectedFile == null) {\n        this.errorMsg = \"Vous devez sélectionner un document !!!\";\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 2000);\n      } else {\n        this.saveDocumentTransport();\n      }\n    },\n    // PREVISUALISATION DU DOCUMENT\n    previewFile() {\n      if (!this.selectedFile) return;\n      const reader = new FileReader();\n      reader.onload = () => {\n        this.filePreview = reader.result;\n        this.isImage = this.selectedFile.type.startsWith(\"image/\");\n      };\n      reader.readAsDataURL(this.selectedFile);\n    },\n    // ENREGISTRER LE DOCUMENT\n    async saveDocumentTransport() {\n      const formData = new FormData();\n      formData.append('file', this.selectedFile);\n      formData.append('raisonSociale', this.compagnieTransportRaisonSociale);\n      await axios.post(API_CREER_DOCUMENT_TRANSPORT, formData, {\n        headers: HEADERS(this.$store.state.userAuthentified.token)\n      }).then(response => {\n        if (response.status == 200) {\n          if (response.data.status.code == 800) {\n            this.successMsg = response.data.status.message;\n            $(\".alert-success\").fadeIn();\n            setTimeout(function () {\n              $(\".alert-success\").fadeOut();\n            }, 4000);\n          } else {\n            this.errorMsg = response.data.status.message;\n            $(\".alert-error\").fadeIn();\n            setTimeout(function () {\n              $(\".alert-error\").fadeOut();\n            }, 3000);\n          }\n        } else if (response.status == 204) {\n          this.warningMsg = \"Erreur , lors de la création de l'offre de voyage\";\n          $(\".alert-warning\").fadeIn();\n          setTimeout(function () {\n            $(\".alert-warning\").fadeOut();\n          }, 3000);\n        } else {\n          this.errorMsg = \"Erreur , opération de création impossible\";\n          $(\".alert-error\").fadeIn();\n          setTimeout(function () {\n            $(\".alert-error\").fadeOut();\n          }, 3000);\n        }\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      }).finally(() => {\n        this.overlay = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"AAsCA;AACA;AACA;AAEA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEAC;IACA;EACA;EAEAC;IAEAC;MACA;QACA;QACAC;QACAC;UACAD;QACA;MACA,OACA;QACA;MACA;IAEA;IAEA;IACAE;MACA;MACA;MACAC;QACA;QACA;MACA;MACAA;IACA;IAEA;IACA;MACA;MACAC;MACAA;MAEA;QACAC;MACA;QACA;UACA;YACA;YACAL;YACAC;cACAD;YACA;UACA;YACA;YACAA;YACAC;cACAD;YACA;UACA;QACA,OACA;UACA;UACAA;UACAC;YACAD;UACA;QACA,OACA;UACA;UACAA;UACAC;YACAD;UACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;QACA;MACA;IACA;EACA;AACA","names":["name","data","successMsg","errorMsg","overlay","selectedFile","filePreview","isImage","compagnieTransportRaisonSociale","methods","submitForm","$","setTimeout","previewFile","reader","formData","headers"],"sourceRoot":"src/components/administration_compagnie_transport","sources":["DocumentAttestationTransport.vue"],"sourcesContent":["<template>\n   <v-app>\n        <v-form @submit.prevent=\"submitForm\">\n            <v-card>\n                <v-card-title>ATTESTION DE TRANSPORT</v-card-title>\n                <v-card-subtitle>Rattachez votre document de transport</v-card-subtitle>\n                <v-container>\n                    <v-row>\n                        <v-col>\n                            <v-file-input v-model=\"selectedFile\" dense rounded accept=\".pdf\" color=\"deep-purple accent-4\" counter\n                                placeholder=\"Choisissez votre document\" prepend-icon=\"mdi-paperclip\" outlined :show-size=\"1000\"\n                                @change=\"previewFile\">\n                            </v-file-input>\n                        </v-col>\n\n                        <v-col>\n                            <div v-if=\"filePreview\">\n                                <h4>{{ selectedFile.name }}</h4>\n                                <img :src=\"filePreview\" v-if=\"isImage\" />\n                                <iframe width=\"100%\" height=\"100%\" :src=\"filePreview\" v-else></iframe>\n                            </div>\n                        </v-col>\n                    </v-row>\n                </v-container>\n                \n                <v-card-actions>\n                    <v-btn small rounded  color=\"secondary\">REINITIALISER</v-btn>\n                    <v-btn type=\"submit\" rounded color=\"primary\" small>ENREGISTRER LE DOCUMENT</v-btn>\n                </v-card-actions>\n            </v-card>\n        </v-form>\n        <v-alert class=\"myalert alert-error\" type=\"error\" width=\"350px\" dismissible>{{ errorMsg }}</v-alert>\n        <v-alert class=\"myalert alert-success\" type=\"success\" width=\"350px\" dismissible>{{ successMsg }}</v-alert>\n        <v-overlay :value=\"overlay\"><v-progress-circular indeterminate size=\"64\"></v-progress-circular></v-overlay>\n   </v-app> \n</template>\n\n<script>\nimport axios from \"axios\";\nimport $ from 'jquery';\nimport { API_CREER_DOCUMENT_TRANSPORT , HEADERS } from '../globalConfig/globalConstConfig'\n\nexport default {\n    name:\"DocumentAttestionTransport\",\n    data() {\n        return {\n            successMsg: null,\n            errorMsg : null,\n            overlay : false,\n\n            selectedFile: null,\n            filePreview: null,\n            isImage: false,\n\n            compagnieTransportRaisonSociale : 'KOUEVI CT'\n        };\n    },\n\n    methods:{\n\n        submitForm(){\n            if (this.selectedFile == null) {\n                this.errorMsg = \"Vous devez sélectionner un document !!!\" ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 2000);\n            }\n            else{\n                this.saveDocumentTransport();\n            }\n            \n        },\n        \n        // PREVISUALISATION DU DOCUMENT\n        previewFile(){\n            if (!this.selectedFile) return;\n            const reader = new FileReader();\n            reader.onload = () => {\n                this.filePreview = reader.result;\n                this.isImage = this.selectedFile.type.startsWith(\"image/\");\n            };\n            reader.readAsDataURL(this.selectedFile);\n        },\n\n        // ENREGISTRER LE DOCUMENT\n        async saveDocumentTransport(){\n            const formData = new FormData();\n            formData.append('file', this.selectedFile); \n            formData.append('raisonSociale', this.compagnieTransportRaisonSociale);\n\n            await axios.post(API_CREER_DOCUMENT_TRANSPORT , formData , {\n                headers:HEADERS(this.$store.state.userAuthentified.token)\n            }).then((response) => {\n                if (response.status == 200) {\n                    if (response.data.status.code == 800) {\n                        this.successMsg = response.data.status.message\n                        $(\".alert-success\").fadeIn();\n                        setTimeout(function(){\n                            $(\".alert-success\").fadeOut(); \n                        }, 4000)\n                    }else{\n                        this.errorMsg = response.data.status.message\n                        $(\".alert-error\").fadeIn();\n                        setTimeout(function(){\n                            $(\".alert-error\").fadeOut(); \n                        }, 3000)\n                    }  \n                }\n                else if (response.status == 204) {\n                    this.warningMsg = \"Erreur , lors de la création de l'offre de voyage\";\n                    $(\".alert-warning\").fadeIn();\n                    setTimeout(function(){\n                        $(\".alert-warning\").fadeOut(); \n                    }, 3000)\n                }\n                else{\n                    this.errorMsg = \"Erreur , opération de création impossible\";\n                    $(\".alert-error\").fadeIn();\n                    setTimeout(function(){\n                        $(\".alert-error\").fadeOut(); \n                    }, 3000)\n                }\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            }).finally(() => {\n                this.overlay = false;\n            })\n        }\n    }\n}\n</script>\n\n<style scoped>\n    .myalert{\n        display: none;\n        z-index: 1900;\n    }\n\n    .alert-success{\n        position: fixed;\n        top: 25px;\n        right:2%;\n        width: 25%;\n    }\n\n    .alert-error{\n        position: fixed;\n        top: 25px;\n        right:2%;\n        width: 25%;\n    }\n\n    .alert-warning{\n        position: fixed;\n        top: 25px;\n        right:2%;\n        width: 25%;\n    }\n</style>"]},"metadata":{},"sourceType":"module"}